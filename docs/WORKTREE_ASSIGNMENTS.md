# ワークツリー別作業分担表

> **作成日**: 2025-01-XX
> **最終更新**: 2025-01-XX
> **目的**: コンフリクトを避けながら、各ワークツリーで効率的に作業を進めるための指示書

---

## 🎯 ワークツリー別作業指示

### 1. `rogs-ui` ワークツリー（UI/UX担当）

**担当者**: UI/UX Specialist AI Agent

**作業内容**:

#### ✅ 優先度：高
1. **レスポンシブデザインの強化（モバイル・タブレット最適化）**
   - モバイル最適化の強化
   - タブレット最適化
   - タッチターゲットサイズの最適化
   - スワイプジェスチャーの追加

2. **アクセシビリティ改善**
   - キーボードナビゲーション完全実装
   - スクリーンリーダー対応
   - WCAG準拠のコントラスト比確認
   - ARIAラベルの適切な使用

3. **TRDSドキュメントの拡張**
   - ファイル: `docs/torii_resonance_design_system.md`
   - 追加内容:
     - ダークモード/ライトモードの切り替え指針
     - アクセシビリティ（a11y）ルール
     - WCAG準拠のコントラスト比ガイドライン
     - キーボードナビゲーション指針
   - **注意**: このドキュメントは全アプリで参照されるため、慎重に編集

4. **共通UIコンポーネントの拡張**
   - `core_components.ex` の拡張
   - 共通レイアウトの統一
   - フォームコンポーネントの改善
   - モーダル・ダイアログコンポーネントの改善

**ブランチ**: `feature/ui-ux` または適切なブランチ

**コンフリクト回避**:
- このワークツリーは `docs/torii_resonance_design_system.md` を独占的に編集
- CSSファイルの変更はこのワークツリーで一元管理
- `core_components.ex` の変更はこのワークツリーのみが行う
- 他のワークツリーはCSSを直接編集しない

---

### 2. `rogs-shinkanki` ワークツリー（ゲームロジック担当）

**担当者**: Main Logic Developer

**作業内容**:

#### ✅ 優先度：高（ゲームプレイに必須）
1. **フェーズ表示UI実装**
   - 現在のフェーズ（イベント、相談、アクション、減衰、生命更新、判定）を視覚的に表示
   - フェーズ進行インジケーター
   - フェーズ説明テキスト

2. **イベントカード表示UI**
   - イベントフェーズでのカード表示
   - イベントカード詳細モーダル
   - イベント効果の説明

3. **才能カードUI**
   - プレイヤーの才能カード表示
   - 才能カードをアクションカードに重ねるUI（最大2枚）

4. **共創プロジェクトカードUI**
   - プロジェクト表示
   - 進行状況の表示
   - 才能カードを捧げるUI

5. **プレイヤー役割選択画面**
   - 4つの役割（森の守り手、文化の継承者、コミュニティの灯火、空環エンジニア）の選択UI
   - 役割ごとの説明と色分け

6. **エンディング画面**
   - 5種類のエンディング（祝福、浄化、揺らぎ、嘆き、即時ゲームオーバー）の専用デザイン
   - ゲーム結果の統計表示

7. **アクション確認UI**
   - カード使用前の確認ダイアログ
   - 効果プレビュー
   - コスト確認

#### ⚠️ 優先度：中（UX向上）
8. **ルーム管理UI**
   - `rogs_comm`のルーム機能を`shinkanki_web`に統合
   - ルーム一覧、作成、参加機能

9. **カード詳細モーダル**
   - カードクリック/ホバーでの詳細表示
   - タイプ説明、コスト・効果の詳細

10. **ゲーム履歴・ログ表示**
    - ターンごとの履歴
    - アクション履歴
    - イベント履歴のスクロール可能パネル

11. **コード整理**
    - 未使用関数の警告解消
    - コードのリファクタリング

**ブランチ**: `feature/shinkanki-dev` または適切なブランチ

**コンフリクト回避**:
- `game_live.ex` のロジック部分のみ編集
- UIスタイル（CSSクラス）の変更は `rogs-ui` に依頼
- `core_components.ex` の変更は `rogs-ui` に依頼
- CSSファイルは直接編集しない

---

### 3. `rogs-identity` ワークツリー（認証担当）

**担当者**: Identity Developer

**作業内容**:

#### ✅ 優先度：中
1. **認証UIにTRDS適用**
   - ログイン画面 (`/users/log-in`)
   - 登録画面 (`/users/register`)
   - パスワードリセット画面 (`/users/forgot-password`, `/users/reset-password/:token`)
   - 設定画面 (`/users/settings`)

**ブランチ**: `feature/identity` または適切なブランチ

**コンフリクト回避**:
- 認証ロジックのみ編集
- UIスタイルの変更は `rogs-ui` に依頼
- `core_components.ex` の変更は `rogs-ui` に依頼
- CSSファイルは直接編集しない

---

### 4. `rogs-chat` ワークツリー（チャット担当）

**担当者**: Chat Developer

**作業内容**:

#### ✅ 優先度：中
1. **チャットUIにTRDS適用**
   - チャット画面のデザイン改善
   - メッセージ表示の改善
   - 入力フォームの改善

**ブランチ**: `feature/chat` または適切なブランチ

**コンフリクト回避**:
- チャットロジックのみ編集
- UIスタイルの変更は `rogs-ui` に依頼
- `core_components.ex` の変更は `rogs-ui` に依頼
- CSSファイルは直接編集しない

---

### 5. `rogs_umbrella` ワークツリー（メイン/マージ担当）

**担当者**: Integration Manager

**作業内容**:

#### ✅ 優先度：高
1. **全ワークツリーの同期**
   - 各ワークツリーの変更が完了したら `./sync_all.sh` を実行
   - 全ワークツリーの変更を `main` ブランチにマージ
   - コンフリクトがあれば解決

2. **デプロイ準備**
   - 全アプリのテストを実行
   - ビルドエラーの確認
   - デプロイ準備

**ブランチ**: `main`

**コンフリクト回避**:
- このワークツリーでは直接コードを編集しない
- マージと同期のみを行う
- 各ワークツリーの変更を取り込む

---

## 🔄 作業フロー

### ステップ1: 各ワークツリーで独立作業
1. `rogs-ui`: レスポンシブデザイン強化、アクセシビリティ改善、TRDSドキュメント拡張、共通コンポーネント拡張
2. `rogs-shinkanki`: ゲームUI実装（フェーズ表示、イベントカード、才能カード、プロジェクトカード、役割選択、エンディング、アクション確認）
3. `rogs-identity`: 認証UIにTRDS適用
4. `rogs-chat`: チャットUIにTRDS適用

### ステップ2: 同期とマージ
1. `rogs_umbrella` で `./sync_all.sh` を実行
2. 各ワークツリーの変更を `main` にマージ
3. コンフリクトがあれば解決

### ステップ3: 最終確認
1. 全アプリのテストを実行
2. ブラウザで各アプリの表示を確認
3. 問題がなければ完了

---

## ⚠️ コンフリクト回避のルール

### 共有リソースの編集ルール

| リソース | 編集権限 | 備考 |
|---------|---------|------|
| `docs/torii_resonance_design_system.md` | `rogs-ui` のみ | 全アプリで参照されるため、一元管理 |
| `apps/*/assets/css/app.css` | `rogs-ui` のみ | UIスタイルは一元管理 |
| `apps/*/lib/*/components/core_components.ex` | `rogs-ui` のみ | 共通コンポーネントは一元管理 |
| `config/config.exs` | 各ワークツリー | アプリ固有の設定のみ編集、コメントで明示 |
| `mix.lock` | 自動生成 | 変更時は他ワークツリーで `mix deps.get` を実行 |

### ブランチ運用ルール

- 各ワークツリーは専用のブランチで作業
- 同じブランチを複数のワークツリーで同時にチェックアウトしない
- `main` ブランチは `rogs_umbrella` でのみ使用

---

## 📝 チェックリスト

### `rogs-ui` ワークツリー
- [ ] レスポンシブデザインの強化（モバイル・タブレット最適化）
- [ ] アクセシビリティ改善（キーボードナビゲーション、スクリーンリーダー対応、WCAG準拠）
- [ ] TRDSドキュメントの拡張（ダーク/ライト指針、a11yルール）
- [ ] 共通UIコンポーネントの拡張

### `rogs-shinkanki` ワークツリー
- [ ] フェーズ表示UI実装
- [ ] イベントカード表示UI
- [ ] 才能カードUI
- [ ] 共創プロジェクトカードUI
- [ ] プレイヤー役割選択画面
- [ ] エンディング画面
- [ ] アクション確認UI
- [ ] ルーム管理UI（中優先度）
- [ ] カード詳細モーダル（中優先度）
- [ ] ゲーム履歴・ログ表示（中優先度）
- [ ] コード整理（中優先度）

### `rogs-identity` ワークツリー
- [ ] 認証UIにTRDS適用（ログイン、登録、パスワードリセット画面）

### `rogs-chat` ワークツリー
- [ ] チャットUIにTRDS適用（チャット画面のデザイン改善）

### `rogs_umbrella` ワークツリー
- [ ] 全ワークツリーの同期
- [ ] 変更を `main` にマージ
- [ ] 全アプリのテスト実行

---

## 🚨 注意事項

1. **共有リソースの編集は慎重に**
   - `core_components.ex` や `app.css` の変更は全アプリに影響
   - 必ず `rogs-ui` ワークツリーで編集

2. **ブランチの二重チェックアウト禁止**
   - 同じブランチを複数のワークツリーで同時にチェックアウトしない

3. **依存関係の同期**
   - `mix.lock` が更新されたら、他のワークツリーで `mix deps.get` を実行

4. **コミット前の確認**
   - 各ワークツリーで `mix test apps/APP_NAME` を実行
   - ビルドエラーがないか確認

5. **CSS編集の禁止**
   - `rogs-shinkanki`, `rogs-identity`, `rogs-chat` はCSSを直接編集せず、必要なスタイル変更は `rogs-ui` に依頼

---

**最終更新**: 2025-01-XX
